import pandas as pd
import streamlit as st

def load_uploaded_file(uploaded_file):
    if uploaded_file is None:
        return None
    try:
        if uploaded_file.name.endswith(".xlsx"):
            return pd.read_excel(uploaded_file)
        elif uploaded_file.name.endswith(".csv"):
            return pd.read_csv(uploaded_file)
        else:
            st.warning("Unsupported file format.")
            return None
    except Exception as e:
        st.error(f"Failed to read file: {e}")
        return None
